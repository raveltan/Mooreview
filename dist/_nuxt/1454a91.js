(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{227:function(t,e,n){"use strict";n.r(e);n(22);var r=n(5),o={data:function(){return{id:"",movieData:{Name:"",Rating:""},addReviewModal:!1,reviewData:[],newComment:"",newRating:5}},created:function(){this.id=this.$route.params.id,this.getMovieData(),this.getReviewData()},methods:{setLoading:function(data){this.$store.commit("loading",data)},getMovieData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoading(!0),e.prev=1,e.next=4,t.$axios.$get("https://moo-api.lightbear.net/api/movie/"+t.id,{headers:{Authorization:"Bearer ".concat(t.$store.state.auth.token)}});case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),e.t0&&alert("Unable to get movie data");case 10:return e.prev=10,t.setLoading(!1),e.finish(10);case 13:n&&(t.movieData=n);case 14:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})))()},getReviewData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoading(!0),e.prev=1,e.next=4,t.$axios.$get("https://moo-api.lightbear.net/api/review/"+t.id,{headers:{Authorization:"Bearer ".concat(t.$store.state.auth.token)}});case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),e.t0&&alert("Unable to get movie data");case 10:return e.prev=10,t.setLoading(!1),e.finish(10);case 13:n&&(t.reviewData=n);case 14:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})))()},addReview:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""===t.newComment||t.newRating>5||t.newRating<0)){e.next=2;break}return e.abrupt("return");case 2:return t.setLoading(!0),e.prev=3,e.next=6,t.$axios.$post("https://moo-api.lightbear.net/api/review/"+t.id+"/add",{Rating:parseInt(t.newRating),Comment:t.newComment},{headers:{Authorization:"Bearer ".concat(t.$store.state.auth.token)}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),e.t0&&alert("Unable to add new review");case 11:return e.prev=11,t.setLoading(!1),t.getMovieData(),t.getReviewData(),t.newComment="",t.newRating=5,t.addReviewModal=!1,e.finish(11);case 19:case"end":return e.stop()}}),e,null,[[3,8,11,19]])})))()}}},c=n(30),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","destroy-on-hide":!1,"aria-role":"dialog","aria-modal":""},model:{value:t.addReviewModal,callback:function(e){t.addReviewModal=e},expression:"addReviewModal"}},[[n("form",{on:{submit:function(e){return e.preventDefault(),t.addReview()}}},[n("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v("Add New Review")]),t._v(" "),n("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.addReviewModal=!1}}})]),t._v(" "),n("section",{staticClass:"modal-card-body"},[n("b-field",{attrs:{label:"Comment"}},[n("b-input",{attrs:{type:"text",placeholder:"This movie is amazing!"},model:{value:t.newComment,callback:function(e){t.newComment=e},expression:"newComment"}})],1),t._v(" "),n("b-field",{attrs:{label:"Rating"}},[n("b-input",{attrs:{type:"number",placeholder:"5",max:"5",min:"0"},model:{value:t.newRating,callback:function(e){t.newRating=e},expression:"newRating"}})],1)],1),t._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){t.addReviewModal=!1}}},[t._v("\n              Close\n            ")]),t._v(" "),n("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v("Add")])])])])]],2),t._v(" "),n("div",{staticClass:"level"},[n("div",{staticClass:"level-left"},[n("div",{staticClass:"level-item"},[n("h1",{staticClass:"mr-3 is-size-3"},[t._v(t._s(t.movieData.Name))]),t._v(" "),n("b-taglist",{attrs:{attached:""}},[n("b-tag",{attrs:{type:"is-primary is-dark"}},[t._v(t._s(t.movieData.Rating))]),t._v(" "),n("b-tag",{attrs:{type:"is-primary is-light"}},[t._v("Star(s)")])],1)],1)]),t._v(" "),n("div",{staticClass:"level-right"},[n("div",{staticClass:"level-item"},[n("b-button",{attrs:{type:"is-primary is-light"},on:{click:function(e){t.addReviewModal=!0}}},[t._v("Add Review")])],1)])]),t._v(" "),n("div",{staticClass:"columns is-multiline"},t._l(t.reviewData,(function(e){return n("div",{key:e.AddedOn,staticClass:"column is-5-tablet is-4-desktop is-3-widescreen"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-content"},[n("p",{staticClass:"title"},[t._v('"'+t._s(e.Comment)+'"')]),t._v(" "),n("p",{staticClass:"subtitle"},[t._v(t._s(e.Author))])]),t._v(" "),n("footer",{staticClass:"card-footer"},[n("p",{staticClass:"card-footer-item"},[n("span",[t._v("\n              "+t._s(e.AddedOn)+"\n            ")])]),t._v(" "),n("p",{staticClass:"card-footer-item"},[n("span",[t._v(" "+t._s(e.Rating)+" Stars ")])])])])])})),0)],1)}),[],!1,null,null,null);e.default=component.exports}}]);